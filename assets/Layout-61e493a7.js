import{j as e,u as t,b as s,q as n,F as i,A as r,B as o,f as a,g as l,n as c,r as d,s as h,t as p,v as x,w as m,x as u,y as f,z as g,H as j,J as b,I as y,M as v,K as w,D as k,L as C,N as P,O as S,Q as T,R as E,S as R}from"./mui-56a233f4.js";import{r as z,i as I,u as M,b as $,L as W}from"./vendor-2c736f18.js";import{u as L,a as A,c as D,d as O}from"./index-566e1fcc.js";import{f as X}from"./index-2d5a8536.js";import{M as B,i as U,u as H,P as F,a as G,b as N,L as q,m as J}from"./proxy-40ab8537.js";import"./utils-18e1ec00.js";class K extends z.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,s=U(e)&&e.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=s-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Q({children:t,isPresent:s,anchorX:n}){const i=z.useId(),r=z.useRef(null),o=z.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=z.useContext(B);return z.useInsertionEffect((()=>{const{width:e,height:t,top:l,left:c,right:d}=o.current;if(s||!r.current||!e||!t)return;const h="left"===n?`left: ${c}`:`right: ${d}`;r.current.dataset.motionPopId=i;const p=document.createElement("style");return a&&(p.nonce=a),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`\n          [data-motion-pop-id="${i}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            ${h}px !important;\n            top: ${l}px !important;\n          }\n        `),()=>{document.head.contains(p)&&document.head.removeChild(p)}}),[s]),e.jsx(K,{isPresent:s,childRef:r,sizeRef:o,children:z.cloneElement(t,{ref:r})})}const V=({children:t,initial:s,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:o,mode:a,anchorX:l})=>{const c=H(Y),d=z.useId();let h=!0,p=z.useMemo((()=>(h=!1,{id:d,initial:s,isPresent:n,custom:r,onExitComplete:e=>{c.set(e,!0);for(const t of c.values())if(!t)return;i&&i()},register:e=>(c.set(e,!1),()=>c.delete(e))})),[n,c,i]);return o&&h&&(p={...p}),z.useMemo((()=>{c.forEach(((e,t)=>c.set(t,!1)))}),[n]),z.useEffect((()=>{!n&&!c.size&&i&&i()}),[n]),"popLayout"===a&&(t=e.jsx(Q,{isPresent:n,anchorX:l,children:t})),e.jsx(F.Provider,{value:p,children:t})};function Y(){return new Map}const Z=e=>e.key||"";function _(e){const t=[];return z.Children.forEach(e,(e=>{z.isValidElement(e)&&t.push(e)})),t}const ee=({children:t,custom:s,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:o="sync",propagate:a=!1,anchorX:l="left"})=>{const[c,d]=G(a),h=z.useMemo((()=>_(t)),[t]),p=a&&!c?[]:h.map(Z),x=z.useRef(!0),m=z.useRef(h),u=H((()=>new Map)),[f,g]=z.useState(h),[j,b]=z.useState(h);N((()=>{x.current=!1,m.current=h;for(let e=0;e<j.length;e++){const t=Z(j[e]);p.includes(t)?u.delete(t):!0!==u.get(t)&&u.set(t,!1)}}),[j,p.length,p.join("-")]);const y=[];if(h!==f){let e=[...h];for(let t=0;t<j.length;t++){const s=j[t],n=Z(s);p.includes(n)||(e.splice(t,0,s),y.push(s))}return"wait"===o&&y.length&&(e=y),b(_(e)),g(h),null}const{forceRender:v}=z.useContext(q);return e.jsx(e.Fragment,{children:j.map((t=>{const f=Z(t),g=!(a&&!c)&&(h===j||p.includes(f));return e.jsx(V,{isPresent:g,initial:!(x.current&&!n)&&void 0,custom:s,presenceAffectsLayout:r,mode:o,onExitComplete:g?void 0:()=>{if(!u.has(f))return;u.set(f,!0);let e=!0;u.forEach((t=>{t||(e=!1)})),e&&(v?.(),b(m.current),a&&d?.(),i&&i())},anchorX:l,children:t},f)}))})},te=280,se=({children:B})=>{const U=t(),H=s(U.breakpoints.down("md")),F=I(),G=M(),{user:N,logout:q}=L(),{currentTheme:K,setTheme:Q}=A(),{activeTimer:V}=D(),{sidebarOpen:Y,toggleSidebar:Z,setSidebarOpen:_}=O(),[se,ne]=z.useState(null),[ie,re]=z.useState(0);$.useEffect((()=>{if(V&&V.isRunning){const e=setInterval((()=>{const e=new Date(V.startTime).getTime(),t=Date.now();re(Math.floor((t-e)/1e3))}),1e3);return()=>clearInterval(e)}}),[V]);const oe=[{text:"Tasks",icon:n,path:"/tasks",color:U.palette.secondary.main},{text:"Projects",icon:i,path:"/projects",color:U.palette.success.main},{text:"Analytics",icon:r,path:"/analytics",color:U.palette.warning.main}],ae=()=>{ne(null)},le=e.jsxs(o,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(o,{sx:{p:3,display:"flex",alignItems:"center",gap:2},children:[e.jsx(a,{sx:{fontSize:32,color:"primary.main"}}),e.jsx(l,{variant:"h6",fontWeight:"bold",color:"primary.main",children:"Tasks Tracker"})]}),e.jsx(c,{}),e.jsx(ee,{children:V&&e.jsxs(J.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsxs(o,{sx:{p:2,backgroundColor:"primary.light",color:"primary.contrastText"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(d,{sx:{fontSize:16}}),e.jsx(l,{variant:"body2",fontWeight:"bold",children:"Active Timer"})]}),e.jsx(l,{variant:"body2",sx:{mb:1},children:V.task?.title||"No title"}),e.jsx(h,{label:X(ie),size:"small",sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"inherit",fontWeight:"bold"}})]}),e.jsx(c,{})]})}),e.jsx(p,{sx:{flex:1,px:2},children:oe.map((t=>{const s=F.pathname===t.path;return e.jsx(x,{disablePadding:!0,sx:{mb:1},children:e.jsxs(m,{component:W,to:t.path,selected:s,sx:{borderRadius:2,backgroundColor:s?`${t.color}15`:"transparent",color:s?t.color:"text.primary","&:hover":{backgroundColor:`${t.color}10`},transition:"all 0.2s"},children:[e.jsx(u,{sx:{color:"inherit",minWidth:40},children:e.jsx(t.icon,{})}),e.jsx(f,{primary:t.text,primaryTypographyProps:{fontWeight:s?600:400}})]})},t.text)}))}),e.jsxs(o,{sx:{p:2},children:[e.jsx(c,{sx:{mb:2}}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(g,{sx:{width:40,height:40},children:N?.name?.charAt(0).toUpperCase()}),e.jsxs(o,{sx:{flex:1},children:[e.jsx(l,{variant:"body2",fontWeight:"bold",children:N?.name}),e.jsx(l,{variant:"caption",color:"text.secondary",children:N?.email})]})]})]})]});return e.jsxs(o,{sx:{display:"flex",minHeight:"100vh"},children:[e.jsx(j,{position:"fixed",sx:{width:{md:Y?"calc(100% - 280px)":"100%"},ml:{md:Y?"280px":0},backgroundColor:"background.paper",color:"text.primary",boxShadow:"none",borderBottom:`1px solid ${U.palette.divider}`,transition:U.transitions.create(["width","margin"],{easing:U.transitions.easing.sharp,duration:U.transitions.duration.leavingScreen})},children:e.jsxs(b,{children:[e.jsx(y,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:()=>{H?_(!Y):Z()},sx:{mr:2},children:e.jsx(v,{})}),e.jsx(l,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1},children:oe.find((e=>e.path===F.pathname))?.text||"Tasks Tracker"}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(w,{title:"Перемкнути тему",children:e.jsx(y,{onClick:()=>{Q("light"===K?"dark":"light")},children:"light"===K?e.jsx(k,{}):e.jsx(C,{})})}),e.jsx(w,{title:"Profile",children:e.jsx(y,{onClick:e=>{ne(e.currentTarget)},children:e.jsx(g,{sx:{width:32,height:32},children:N?.name?.charAt(0).toUpperCase()})})})]})]})}),e.jsxs(P,{anchorEl:se,open:Boolean(se),onClose:ae,onClick:ae,PaperProps:{elevation:8,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1.5,minWidth:200}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[e.jsxs(S,{onClick:()=>G("/profile"),children:[e.jsx(u,{children:e.jsx(T,{fontSize:"small"})}),"Profile"]}),e.jsx(c,{}),e.jsxs(S,{onClick:()=>{q(),ae()},children:[e.jsx(u,{children:e.jsx(E,{fontSize:"small"})}),"Logout"]})]}),e.jsx(o,{component:"nav",sx:{width:{md:Y?te:0},flexShrink:{md:0}},children:e.jsx(R,{variant:H?"temporary":"persistent",open:Y,onClose:()=>_(!1),ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{boxSizing:"border-box",width:te,borderRight:`1px solid ${U.palette.divider}`,backgroundColor:"background.paper"}},children:le})}),e.jsxs(o,{component:"main",sx:{flexGrow:1,width:{md:Y?"calc(100% - 280px)":"100%"},transition:U.transitions.create(["width","margin"],{easing:U.transitions.easing.sharp,duration:U.transitions.duration.leavingScreen})},children:[e.jsx(b,{}),e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:B})]})]})};export{se as default};
